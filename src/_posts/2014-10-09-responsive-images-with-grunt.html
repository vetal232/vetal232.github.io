---
title: Responsive Images with Grunt
tags: [web dev, grunt, open source, responsive design]
modified: 2014-10-12
---

<p>Thanks to constant improvements of the <a href="https://html.spec.whatwg.org/multipage/embedded-content.html">HTML Living Standard</a> and the work of the <a href="http://responsiveimages.org/#implementation">Responsive Images Community Group</a>, web developers are more than ever invited to actually make images responsive. With a little <i>Grunt</i> magic this task can be realized in a snap.</p>

<p>This post is not an introduction to native responsive images. Yoav Weiss already did <a href="https://dev.opera.com/articles/native-responsive-images/">an amazing job</a> there. Also, when I talk about responsive images I refer to the enhanced <code>&lt;img&gt;</code> tag with <code>srcset</code> and <code>sizes</code> attributes. The celebrated <code>&lt;picture&gt;</code> is not the best solution in most cases and should only be used for art direction. Read <a href="http://blog.cloudfour.com/dont-use-picture-most-of-the-time/">here</a> why.</p>

<p>Let&rsquo;s get our hands dirty. Responsive images require that your web site&rsquo;s image files exist in several resolutions. Enter the <a href="https://github.com/andismith/grunt-responsive-images/">grunt-responsive-images</a> task that produces images in different sizes. That&rsquo;s half the battle already. Let&rsquo;s assume we created the following image files with the plugin&rsquo;s default settings:</p>

{% highlight bash %}
photo.jpg
photo-small.jpg
photo-medium.jpg
photo-large.jpg
{% endhighlight %}

<p>What we need now is another Grunt plugin that can incorporate those image files into our HTML code and produce something like:</p>

{% highlight html %}
<img src="photo.jpg"
     srcset="photo-small.jpg 320w
             photo-medium.jpg 640w
             photo-large.jpg 1024w"
     alt="An awesome photo">
{% endhighlight %}

<p>This already enables the browser to choose one of the files with respect to the viewport size. Without a <code>sizes</code> attribute it assumes an image size of <code>100vw</code>, though. This will hardly be the case for all your images, especially in very elaborate layouts. Therefore it would be even better if we could provide the browser more information:</p>

{% highlight html %}
<img src="photo.jpg"
     srcset="photo-small.jpg 320w
             photo-medium.jpg 640w
             photo-large.jpg 1024w"
     sizes="(max-width: 20em) 100vw,
            (max-width: 30em) 50vw,
            90vw"
     alt="An awesome photo">
{% endhighlight %}

<p>Unfortunately, my research for a Grunt plugin that could do all this was not successful. All I have found is the <a href="https://github.com/miller/grunt-responsive-images-converter/">grunt-responsive-images-converter</a> task. It scans your sources for markdown files and replaces image tags with the <code>&lt;picture&gt;</code> element. This is not helpful since I was looking for a plugin than can handle HTML files and would use the <code>&lt;img&gt;</code> element.</p>

<p>Time to write <em>my own</em> Grunt plugin. This is what I came up with: The <a href="https://github.com/smaxtastic/grunt-responsive-images-extender">grunt-responsive-images-extender</a>.</p>

<p>It is also available via the npm, so this simple line in your project&rsquo;s root folder</p>

{% highlight bash %}
$ npm install grunt-responsive-images-extender --save-dev
{% endhighlight %}

<p>makes you all set. Take a look at this blog&rsquo;s <a href="https://github.com/smaxtastic/stephanmax.is/blob/master/Gruntfile.js">Gruntfile</a> to see the plugin in action.</p>

<p>The <code>srcset</code> part works pretty good already. The <code>sizes</code> chunk on the other hand needs some major improvements. So far you can only configure <em>one</em> <code>sizes</code> array for your whole web site. That means the same sizes are used for each and every image, regardless whether it is a hero image, an article photo or a tiny icon. This renders the feature pretty much useless, but I&rsquo;m on it and will extend the plugin to match certain image selectors with different sizes.</p>

<p>Until then feel free to experiment with the Grunt task. The browser support for responsive images is <a href="http://caniuse.com/#search=srcset">far from perfect</a>, but the <code>src</code> attribute is a safe fallback option. So you can start implementing responsive images today without drawbacks! Let me know what you think and drop me a line on <a href="https://twitter.com/smaxtastic">Twitter</a>.</p>

<p><ins datetime="2014-10-12">Update Oct 12: The <a href="https://github.com/smaxtastic/grunt-responsive-images-extender">plugin</a> got a major update. Especially the <code>sizes</code> option got improved and I added an <code>ignore</code> list.</ins></p>
